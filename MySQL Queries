SELECT TOP (1000) [Product type]
      ,[SKU]
      ,[Price]
      ,[Availability]
      ,[Number of products sold]
      ,[Revenue generated]
      ,[Customer demographics]
      ,[Stock levels]
      ,[Lead times]
      ,[Order quantities]
      ,[Shipping times]
      ,[Shipping carriers]
      ,[Shipping costs]
      ,[Supplier name]
      ,[State]
      ,[Lead time]
      ,[Production volumes]
      ,[Manufacturing lead time]
      ,[Manufacturing costs]
      ,[Inspection results]
      ,[Defect rates]
      ,[Transportation modes]
      ,[Routes]
      ,[Costs]
  FROM [SupplyChainData].[dbo].['Supply Chain Data$']

 --1. Total Revenue by Product Type
-- Calculate the total revenue generated by each product type to identify the most profitable products:
SELECT 
    [Product type],
    SUM([Revenue generated]) AS Total_Revenue
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [Product type]
ORDER BY 
    Total_Revenue DESC;

-- 2. Shipping Costs by Carrier
--Calculate the average shipping costs for each shipping carrier to evaluate which carrier is the most cost-effective:
SELECT 
    [Shipping carriers],
    AVG([Shipping costs]) AS Average_Shipping_Cost
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [Shipping carriers]
ORDER BY 
    Average_Shipping_Cost ASC;


--3. Lead Times by Supplier
--Calculate the average lead times for each supplier to assess their reliability in delivering products on time:
SELECT 
    [Supplier name],
    AVG([Lead times]) AS Average_Lead_Time
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [Supplier name]
ORDER BY 
    Average_Lead_Time ASC;


--4. Total Products Sold by Location
--Determine the total number of products sold in each location to understand regional demand:
SELECT 
    [State],
    SUM([Number of products sold]) AS Total_Products_Sold
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [State]
ORDER BY 
    Total_Products_Sold DESC;


--5. Defect Rates by Inspection Results
--Calculate the defect rates for different inspection results to assess product quality:
SELECT 
    [Inspection results],
    AVG([Defect rates]) AS Average_Defect_Rate
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [Inspection results]
ORDER BY 
    Average_Defect_Rate DESC;



--6. Ranking Products by Profitability
--Rank products based on profitability, where profitability is calculated as (Revenue generated - Manufacturing costs - Shipping costs):
SELECT 
    [SKU],
    [Product type],
    ([Revenue generated] - [Manufacturing costs] - [Shipping costs]) AS Profitability
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
ORDER BY 
    Profitability DESC;


--7. Supplier Performance Analysis
--Calculate the average lead time for each supplier and identify suppliers with lead times higher than the overall average:
-- Calculate average lead time for each supplier
WITH SupplierLeadTimes AS (
    SELECT 
        [Supplier name],
        AVG([Lead times]) AS Average_Lead_Time
    FROM 
        [SupplyChainData].[dbo].['Supply Chain Data$']
    GROUP BY 
        [Supplier name]
),

-- Calculate the overall average lead time
OverallAverageLeadTime AS (
    SELECT 
        AVG([Lead times]) AS Overall_Average_Lead_Time
    FROM 
        [SupplyChainData].[dbo].['Supply Chain Data$']
)

-- Select suppliers with lead times higher than the overall average
SELECT 
    s.[Supplier name],
    s.Average_Lead_Time,
    o.Overall_Average_Lead_Time
FROM 
    SupplierLeadTimes s
CROSS JOIN 
    OverallAverageLeadTime o
WHERE 
    s.Average_Lead_Time > o.Overall_Average_Lead_Time
ORDER BY 
    s.Average_Lead_Time DESC;



--8. Top 5 Shipping Carriers by Cost Efficiency
--Determine the top 5 shipping carriers with the lowest average shipping costs per product shipped:
SELECT 
    TOP 5 [Shipping carriers],
    AVG([Shipping costs]) AS Average_Shipping_Cost
FROM 
    [SupplyChainData].[dbo].['Supply Chain Data$']
GROUP BY 
    [Shipping carriers]
ORDER BY 
    Average_Shipping_Cost ASC;






